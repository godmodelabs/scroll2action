(function(a){var b=null;var c=[];a.fn.scroll2action=function(){var d={f:{init:false,locked:false,disableSnapping:true,mouseScrollActive:false,mouseEntered:false},elements:{},elementCount:0,speed:null,init:function(){if(d.f.init){return}d.f.init=true;if(window.addEventListener){window.addEventListener("DOMMouseScroll",d.scrollHandler,false)}window.onmousewheel=document.onmousewheel=d.scrollHandler},start:function(b){var c="s2a_"+ ++d.elementCount;d.elements[c]={parent:b};d.wrapContent(d.elements[c]);d.addScrollbar(d.elements[c]);d.addViews(d.elements[c]);d.addStyling(d.elements[c]);d.speed=d.getSpeed(d.getBrowser(a.browser))||2},wrapContent:function(b){b.content=a("<div class='s2a_content'></div>");b.parent.append(b.content.append(a("<div></div>").append(a("> *",b.parent))))},addScrollbar:function(b){b.scrollBar=a("<div class='s2a_scroll hidden'></div>");b.scrollBarHandler=a("<div class='s2a_handler' ></div>");var c=b.parent.innerHeight(),e=b.content.innerHeight();d.bindScrollbarHandler(b.scrollBarHandler);b.scrollBar.hover(function(){a(this).addClass("hover")},function(){if(!d.f.mouseScrollActive){a(this).removeClass("hover")}});b.parent.hover(function(){d.f.mouseEntered=true;b.scrollBar.removeClass("hidden")},function(){d.f.mouseEntered=false;if(!d.f.mouseScrollActive){b.scrollBar.addClass("hidden")}});b.scrollBar.height(c);b.scrollBarHandler.height(~~(c/e*c));b.parent.append(b.scrollBar.append(b.scrollBarHandler))},bindScrollbarHandler:function(){var b=null;var c=null;var e=0;return function(f){f.mousedown(function(a){c=d.findUp(this);b=a.pageY;d.f.mouseScrollActive=true;e=~~c.content.attr("data-s2a-pos")});a("body").mouseup(function(){d.f.mouseScrollActive=false;c.scrollBar.removeClass("hover");if(!d.f.mouseEntered){c.scrollBar.addClass("hidden")}});a("body").mousemove(function(a){if(!d.f.mouseScrollActive){return}d.scrollTo(c,e+a.pageY-b,true)})}}(),addViews:function(b){b.viewTop=a("<div class='s2a_view s2a_viewTop'></div>");b.viewBottom=a("<div class='s2a_view s2a_viewBottom'></div>");b.parent.prepend(b.viewTop).append(b.viewBottom)},addStyling:function(a){a.parent.css("position","relative").css("overflow","hidden");var b=a.parent.height();var c=a.parent.width();a.content.height(b);a.viewBottom.width(c);a.viewTop.width(c)},findUp:function(b){var c=false;a.each(d.elements,function(d,e){if(e.parent[0]===a(b)[0]){c=e}});if(c){return c}var e=b.parentElement||b.parentNode;if(e===null){return false}return d.findUp(e)},getSpeed:function(){var a={webkit:2,ie:3,opera:2,mozilla:2.5};return function(b){return b in a?a[b]:false}}(),getBrowser:function(a){if(a.webkit){return"webkit"}if(a.msie){return"ie"}if(a.opera){return"opera"}if(a.mozilla){return"mozilla"}return false},scrollHandler:function(b){if(!b){b=window.event}var c=d.findUp(a.event.fix(b).target);if(!!c){var e=b.wheelDelta?b.wheelDelta:b.detail?-b.detail:0;d.scroll(c,e);if(b.preventDefault){b.preventDefault()}b.returnValue=false}},scrollTo:function(b,c,d){var e=b.parent.innerHeight(),f=a(" > div",b.content).innerHeight();f=f<e?e:f;var g=e/f,h=~~(g*e);if(d){c=c/g}var i=~~(g*c);b.content.scrollTop(c);b.content.attr("data-s2a-pos",c*g);b.scrollBarHandler.css("top",i+h>e?e-h-2:i<0?0:i)},scroll:function(e,f){if(d.f.locked){return}f=f>0;var g=e.content.scrollTop()+d.speed*-1*(f?10:-10),h=e.content.innerHeight(),i=a("> div",e.content).innerHeight();i=i<h?h:i;var j=e.content.hasClass("s2a_top")?1:e.content.hasClass("s2a_bottom")?-1:0,k=~~(h/i*h);if(j>0&&f||j<0&&!f){return}if(j>0&&!f){e.content.removeClass("s2a_top");e.viewTop.removeClass("s2a_top");e.scrollBarHandler.height(k);d.f.locked=true;window.setTimeout(function(){d.f.locked=false},400);return}if(j<0&&f){e.content.removeClass("s2a_bottom");e.viewBottom.removeClass("s2a_bottom");e.scrollBarHandler.height(k);d.f.locked=true;window.setTimeout(function(){d.f.locked=false},400);return}d.scrollTo(e,g);if(g<0){e.content.addClass("s2a_top");e.viewTop.addClass("s2a_top");e.scrollBarHandler.height(k/2);if(d.f.disableSnapping){window.clearTimeout(b);b=window.setTimeout(function(){window.clearTimeout(b);b=null;e.content.removeClass("s2a_top");e.viewTop.removeClass("s2a_top");e.scrollBarHandler.height(k);e.scrollBar.removeClass("s2a_top")},150)}}else if(g>i-h){e.content.addClass("s2a_bottom");e.viewBottom.addClass("s2a_bottom");e.scrollBarHandler.css("top","auto");e.scrollBarHandler.css("bottom",0);e.scrollBarHandler.height(k/2);a.each(c,function(a,b){window.clearInterval(b)});c=[];c.push(window.setInterval(function(){e.content.scrollTop(h+i)},10));window.setTimeout(function(){a.each(c,function(a,b){window.clearInterval(b)});c=[]},800);if(d.f.disableSnapping){b=window.setTimeout(function(){window.clearTimeout(b);b=null;e.content.removeClass("s2a_bottom");e.viewBottom.removeClass("s2a_bottom");e.scrollBarHandler.height(k)},150)}}}};return this.each(function(){d.init();d.start(a(this))})}})(jQuery)